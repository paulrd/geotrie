# ca.cawala/geotrie

Creates heirarchical population clusters from a geotiff file by populating an SQLITE database. 
This is meant to
be used from the clojure repl. It has a hard-coded tif file name which expects
to be located in the resources folder. It has a hard-coded number of threads
(8). See the comment in the sql.clj file to make sure the region table is
created. Then run (-main `layer-number`). Start with 1. Then run with 2, etc.
It is computationally intensive. I ran it with 7 layers with the following run
times for each: 

- layer 1: 176 seconds, 8 regions
- layer 2: 126 seconds, 64 regions, 72 total
- layer 3 100 seconds, 480 regions, 552 total
- layer 4 90 seconds, 3616 regions, 4168 total
- layer 5 99 seconds, 26592 regions, 30760 total
- layer 6 389 seconds, 195803 regions, 226563 total
- layer 7 40 minutes, 1451807 regions, 1678370 total

## Usage
- create table using statement found in sql.clj.
- call (-main `layer-number`)

Invoke a library API function from the command-line:

    $ clojure -X ca.cawala.geotrie/foo :a 1 :b '"two"'
    {:a 1, :b "two"} "Hello, World!"

Run the project's tests (they'll fail until you edit them):

    $ clojure -T:build test

Run the project's CI pipeline and build a JAR (this will fail until you edit the tests to pass):

    $ clojure -T:build ci

This will produce an updated `pom.xml` file with synchronized dependencies inside the `META-INF`
directory inside `target/classes` and the JAR in `target`. You can update the version (and SCM tag)
information in generated `pom.xml` by updating `build.clj`.

Install it locally (requires the `ci` task be run first):

    $ clojure -T:build install

Deploy it to Clojars -- needs `CLOJARS_USERNAME` and `CLOJARS_PASSWORD` environment
variables (requires the `ci` task be run first):

    $ clojure -T:build deploy

Your library will be deployed to ca.cawala/geotrie on clojars.org by default.

## License

Copyright Â© 2025 Paul

_EPLv1.0 is just the default for projects generated by `deps-new`: you are not_
_required to open source this project, nor are you required to use EPLv1.0!_
_Feel free to remove or change the `LICENSE` file and remove or update this_
_section of the `README.md` file!_

Distributed under the Eclipse Public License version 1.0.
